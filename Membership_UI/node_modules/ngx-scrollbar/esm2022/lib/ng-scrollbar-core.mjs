import { Directive, Input, Output, inject, signal, effect, computed, numberAttribute, booleanAttribute, runInInjectionContext, input, EventEmitter, ElementRef, NgZone, Injector } from '@angular/core';
import { Platform } from '@angular/cdk/platform';
import { Directionality } from '@angular/cdk/bidi';
import { toSignal } from '@angular/core/rxjs-interop';
import { map, tap } from 'rxjs';
import { SmoothScrollManager } from 'ngx-scrollbar/smooth-scroll';
import { NG_SCROLLBAR } from './utils/scrollbar-base';
import { resizeObserver, ViewportAdapter } from './viewport';
import { ScrollbarUpdateReason, NG_SCROLLBAR_OPTIONS } from './ng-scrollbar.model';
import * as i0 from "@angular/core";
const defaultOptions = {
    trackClass: '',
    thumbClass: '',
    buttonClass: '',
    orientation: 'auto',
    appearance: 'native',
    visibility: 'native',
    position: 'native',
    trackScrollDuration: 50,
    sensorThrottleTime: 0,
    disableSensor: false,
    disableInteraction: false,
    buttons: false
};
export class NgScrollbarCore {
    constructor() {
        /** Injected options */
        this.injectedOptions = inject(NG_SCROLLBAR_OPTIONS, { optional: true });
        /** Combine injected option with default options */
        this.options = this.injectedOptions ? { ...defaultOptions, ...this.injectedOptions } : defaultOptions;
        this.zone = inject(NgZone);
        this.platform = inject(Platform);
        this.injector = inject(Injector);
        /** A flag that indicates if the platform is mobile */
        this.isMobile = this.platform.IOS || this.platform.ANDROID;
        this.dir = inject(Directionality);
        this.smoothScroll = inject(SmoothScrollManager);
        this.nativeElement = inject((ElementRef)).nativeElement;
        /**
         * Indicates when scrollbar thumb is being dragged
         */
        this.dragging = signal('none');
        /**
         * Sets the supported scroll track of the viewport, there are 3 options:
         *
         * - `vertical` Use both vertical and horizontal scrollbar
         * - `horizontal` Use both vertical and horizontal scrollbar
         * - `auto` Use both vertical and horizontal scrollbar
         */
        this.orientation = input(this.options.orientation);
        /**
         * When to show the scrollbar, and there are 3 options:
         *
         * - `native` (default) Scrollbar will be visible when viewport is scrollable like with native scrollbar
         * - `hover` Scrollbars are hidden by default, only visible on scrolling or hovering
         * - `always` Scrollbars are always shown even if the viewport is not scrollable
         */
        this.visibility = input(this.options.visibility);
        /** Show scrollbar buttons */
        this.buttons = input(this.options.buttons, {
            transform: booleanAttribute
        });
        /** Disables scrollbar interaction like dragging thumb and jumping by track click */
        this.disableInteraction = input(this.options.disableInteraction, {
            transform: booleanAttribute
        });
        /** Whether ResizeObserver is disabled */
        this.disableSensor = input(this.options.disableSensor, {
            transform: booleanAttribute
        });
        /** Throttle interval for detecting changes via ResizeObserver */
        this.sensorThrottleTime = input(this.options.sensorThrottleTime, {
            transform: numberAttribute
        });
        this.viewportDimension = signal({
            contentHeight: 0,
            contentWidth: 0,
            offsetHeight: 0,
            offsetWidth: 0
        });
        this.state = computed(() => {
            let verticalUsed = false;
            let horizontalUsed = false;
            let isVerticallyScrollable = false;
            let isHorizontallyScrollable = false;
            const orientation = this.orientation();
            const visibility = this.visibility();
            const viewport = this.viewportDimension();
            // Check if vertical scrollbar should be displayed
            if (orientation === 'auto' || orientation === 'vertical') {
                isVerticallyScrollable = viewport.contentHeight > viewport.offsetHeight;
                verticalUsed = visibility === 'visible' || isVerticallyScrollable;
            }
            // Check if horizontal scrollbar should be displayed
            if (orientation === 'auto' || orientation === 'horizontal') {
                isHorizontallyScrollable = viewport.contentWidth > viewport.offsetWidth;
                horizontalUsed = visibility === 'visible' || isHorizontallyScrollable;
            }
            return {
                verticalUsed,
                horizontalUsed,
                isVerticallyScrollable,
                isHorizontallyScrollable,
            };
        });
        this.isVerticallyScrollable = computed(() => this.state().isVerticallyScrollable);
        this.isHorizontallyScrollable = computed(() => this.state().isHorizontallyScrollable);
        this.verticalUsed = computed(() => this.state().verticalUsed);
        this.horizontalUsed = computed(() => this.state().horizontalUsed);
        /** Scroll duration when the scroll track is clicked */
        this.trackScrollDuration = this.options.trackScrollDuration;
        /**
         *  Sets the appearance of the scrollbar, there are 2 options:
         *
         * - `native` (default) scrollbar space will be reserved just like with native scrollbar.
         * - `compact` scrollbar doesn't reserve any space, they are placed over the viewport.
         */
        this.appearance = this.options.appearance;
        /**
         * Sets the position of each scrollbar, there are 4 options:
         *
         * - `native` (Default) Use the default position like in native scrollbar.
         * - `invertY` Inverts vertical scrollbar position
         * - `invertX` Inverts Horizontal scrollbar position
         * - `invertAll` Inverts both scrollbar positions
         */
        this.position = this.options.position;
        /** A class forwarded to the scrollbar track element */
        this.trackClass = this.options.trackClass;
        /** A class forwarded to the scrollbar thumb element */
        this.thumbClass = this.options.thumbClass;
        /** A class forwarded to the scrollbar button element */
        this.buttonClass = this.options.thumbClass;
        /** Steam that emits when scrollbar is initialized */
        this.afterInit = new EventEmitter();
        /** Steam that emits when scrollbar is updated */
        this.afterUpdate = new EventEmitter();
        /** Viewport adapter instance */
        this.viewport = new ViewportAdapter();
    }
    ngOnInit() {
        runInInjectionContext(this.injector, () => {
            // The direction signal cannot be initialized in the constructor
            // Because it initially returns 'ltr' even if dir.value is 'rtl`
            this.direction = toSignal(this.dir.change.pipe(map(() => this.dir.value)), { initialValue: this.dir.value });
            effect((onCleanup) => {
                // Check whether sensor should be enabled
                if (this.disableSensor()) {
                    // If sensor is disabled update manually
                    this.sizeChangeSub?.unsubscribe();
                }
                else {
                    if (this.platform.isBrowser && this.viewport.initialized()) {
                        this.sizeChangeSub?.unsubscribe();
                        this.zone.runOutsideAngular(() => {
                            this.sizeChangeSub = resizeObserver({
                                element: this.viewport.nativeElement,
                                contentWrapper: this.viewport.contentWrapperElement,
                                throttleDuration: this.sensorThrottleTime()
                            }).pipe(tap((reason) => this.update(reason))).subscribe();
                        });
                    }
                }
                onCleanup(() => this.sizeChangeSub?.unsubscribe());
            });
        });
    }
    ngAfterViewInit() {
        // If sensor is disabled, update to evaluate the state
        if (this.platform.isBrowser && this.disableSensor()) {
            // In case of 3rd party library, need to wait for content to be rendered
            requestAnimationFrame(() => {
                this.update(ScrollbarUpdateReason.AfterInit);
            });
        }
    }
    /**
     * Update local state and the internal scrollbar controls
     */
    update(reason) {
        this.updateCSSVariables();
        this.zone.run(() => {
            this.viewportDimension.set({
                contentHeight: this.viewport.contentHeight,
                contentWidth: this.viewport.contentWidth,
                offsetHeight: this.viewport.offsetHeight,
                offsetWidth: this.viewport.offsetWidth
            });
            // After the upgrade to Angular 18, the effect functions in the inner directives are executed after "afterInit" is emitted,
            // causing the tests to fail. A tiny delay is needed before emitting to the output as a workaround.
            if (reason === ScrollbarUpdateReason.AfterInit) {
                this.afterInit.emit();
            }
            else {
                this.afterUpdate.emit();
            }
        });
    }
    /**
     * Smooth scroll functions
     */
    scrollTo(options) {
        return this.smoothScroll.scrollTo(this.viewport.nativeElement, options);
    }
    /**
     * Scroll to element by reference or selector
     */
    scrollToElement(target, options) {
        return this.smoothScroll.scrollToElement(this.viewport.nativeElement, target, options);
    }
    /**
     * Update Essential CSS variables
     */
    updateCSSVariables() {
        this.nativeElement.style.setProperty('--content-height', `${this.viewport.contentHeight}`);
        this.nativeElement.style.setProperty('--content-width', `${this.viewport.contentWidth}`);
        this.nativeElement.style.setProperty('--viewport-height', `${this.viewport.offsetHeight}`);
        this.nativeElement.style.setProperty('--viewport-width', `${this.viewport.offsetWidth}`);
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.0.1", ngImport: i0, type: NgScrollbarCore, deps: [], target: i0.ɵɵFactoryTarget.Directive }); }
    static { this.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "17.1.0", version: "18.0.1", type: NgScrollbarCore, inputs: { orientation: { classPropertyName: "orientation", publicName: "orientation", isSignal: true, isRequired: false, transformFunction: null }, visibility: { classPropertyName: "visibility", publicName: "visibility", isSignal: true, isRequired: false, transformFunction: null }, buttons: { classPropertyName: "buttons", publicName: "buttons", isSignal: true, isRequired: false, transformFunction: null }, disableInteraction: { classPropertyName: "disableInteraction", publicName: "disableInteraction", isSignal: true, isRequired: false, transformFunction: null }, disableSensor: { classPropertyName: "disableSensor", publicName: "disableSensor", isSignal: true, isRequired: false, transformFunction: null }, sensorThrottleTime: { classPropertyName: "sensorThrottleTime", publicName: "sensorThrottleTime", isSignal: true, isRequired: false, transformFunction: null }, trackScrollDuration: { classPropertyName: "trackScrollDuration", publicName: "trackScrollDuration", isSignal: false, isRequired: false, transformFunction: numberAttribute }, appearance: { classPropertyName: "appearance", publicName: "appearance", isSignal: false, isRequired: false, transformFunction: null }, position: { classPropertyName: "position", publicName: "position", isSignal: false, isRequired: false, transformFunction: null }, trackClass: { classPropertyName: "trackClass", publicName: "trackClass", isSignal: false, isRequired: false, transformFunction: null }, thumbClass: { classPropertyName: "thumbClass", publicName: "thumbClass", isSignal: false, isRequired: false, transformFunction: null }, buttonClass: { classPropertyName: "buttonClass", publicName: "buttonClass", isSignal: false, isRequired: false, transformFunction: null } }, outputs: { afterInit: "afterInit", afterUpdate: "afterUpdate" }, host: { properties: { "class.ng-scrollbar": "true", "attr.verticalUsed": "verticalUsed()", "attr.horizontalUsed": "horizontalUsed()", "attr.isVerticallyScrollable": "isVerticallyScrollable()", "attr.isHorizontallyScrollable": "isHorizontallyScrollable()", "attr.mobile": "isMobile", "attr.dir": "direction()", "attr.position": "position", "attr.dragging": "dragging()", "attr.appearance": "appearance", "attr.visibility": "visibility()", "attr.orientation": "orientation()", "attr.disableInteraction": "disableInteraction()" } }, providers: [{ provide: NG_SCROLLBAR, useExisting: NgScrollbarCore }], ngImport: i0 }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.0.1", ngImport: i0, type: NgScrollbarCore, decorators: [{
            type: Directive,
            args: [{
                    host: {
                        '[class.ng-scrollbar]': 'true',
                        '[attr.verticalUsed]': 'verticalUsed()',
                        '[attr.horizontalUsed]': 'horizontalUsed()',
                        '[attr.isVerticallyScrollable]': 'isVerticallyScrollable()',
                        '[attr.isHorizontallyScrollable]': 'isHorizontallyScrollable()',
                        '[attr.mobile]': 'isMobile',
                        '[attr.dir]': 'direction()',
                        '[attr.position]': 'position',
                        '[attr.dragging]': 'dragging()',
                        '[attr.appearance]': 'appearance',
                        '[attr.visibility]': 'visibility()',
                        '[attr.orientation]': 'orientation()',
                        '[attr.disableInteraction]': 'disableInteraction()'
                    },
                    providers: [{ provide: NG_SCROLLBAR, useExisting: NgScrollbarCore }]
                }]
        }], propDecorators: { trackScrollDuration: [{
                type: Input,
                args: [{ transform: numberAttribute }]
            }], appearance: [{
                type: Input
            }], position: [{
                type: Input
            }], trackClass: [{
                type: Input
            }], thumbClass: [{
                type: Input
            }], buttonClass: [{
                type: Input
            }], afterInit: [{
                type: Output
            }], afterUpdate: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmctc2Nyb2xsYmFyLWNvcmUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wcm9qZWN0cy9uZ3gtc2Nyb2xsYmFyL3NyYy9saWIvbmctc2Nyb2xsYmFyLWNvcmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUNMLFNBQVMsRUFDVCxLQUFLLEVBQ0wsTUFBTSxFQUNOLE1BQU0sRUFDTixNQUFNLEVBQ04sTUFBTSxFQUNOLFFBQVEsRUFDUixlQUFlLEVBQ2YsZ0JBQWdCLEVBQ2hCLHFCQUFxQixFQUNyQixLQUFLLEVBQ0wsWUFBWSxFQUdaLFVBQVUsRUFDVixNQUFNLEVBR04sUUFBUSxFQUlULE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUNqRCxPQUFPLEVBQWEsY0FBYyxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDOUQsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQ3RELE9BQU8sRUFBZ0IsR0FBRyxFQUFFLEdBQUcsRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUM5QyxPQUFPLEVBRUwsbUJBQW1CLEVBR3BCLE1BQU0sNkJBQTZCLENBQUM7QUFFckMsT0FBTyxFQUFnQixZQUFZLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUNwRSxPQUFPLEVBQUUsY0FBYyxFQUFFLGVBQWUsRUFBRSxNQUFNLFlBQVksQ0FBQztBQUU3RCxPQUFPLEVBSUwscUJBQXFCLEVBR3JCLG9CQUFvQixFQUNyQixNQUFNLHNCQUFzQixDQUFDOztBQUU5QixNQUFNLGNBQWMsR0FBdUI7SUFDekMsVUFBVSxFQUFFLEVBQUU7SUFDZCxVQUFVLEVBQUUsRUFBRTtJQUNkLFdBQVcsRUFBRSxFQUFFO0lBQ2YsV0FBVyxFQUFFLE1BQU07SUFDbkIsVUFBVSxFQUFFLFFBQVE7SUFDcEIsVUFBVSxFQUFFLFFBQVE7SUFDcEIsUUFBUSxFQUFFLFFBQVE7SUFDbEIs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LEVBQUUsU0FBUyxFQUFFLGVBQWUsRUFBRTtnQkFRNUIsVUFBVTtzQkFBbEIsS0FBSztnQkFTRyxRQUFRO3NCQUFoQixLQUFLO2dCQUdHLFVBQVU7c0JBQWxCLEtBQUs7Z0JBRUcsVUFBVTtzQkFBbEIsS0FBSztnQkFFRyxXQUFXO3NCQUFuQixLQUFLO2dCQUdJLFNBQVM7c0JBQWxCLE1BQU07Z0JBR0csV0FBVztzQkFBcEIsTUFBTSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgRGlyZWN0aXZlLFxyXG4gIElucHV0LFxyXG4gIE91dHB1dCxcclxuICBpbmplY3QsXHJcbiAgc2lnbmFsLFxyXG4gIGVmZmVjdCxcclxuICBjb21wdXRlZCxcclxuICBudW1iZXJBdHRyaWJ1dGUsXHJcbiAgYm9vbGVhbkF0dHJpYnV0ZSxcclxuICBydW5JbkluamVjdGlvbkNvbnRleHQsXHJcbiAgaW5wdXQsXHJcbiAgRXZlbnRFbWl0dGVyLFxyXG4gIE9uSW5pdCxcclxuICBBZnRlclZpZXdJbml0LFxyXG4gIEVsZW1lbnRSZWYsXHJcbiAgTmdab25lLFxyXG4gIFNpZ25hbCxcclxuICBJbnB1dFNpZ25hbCxcclxuICBJbmplY3RvcixcclxuICBXcml0YWJsZVNpZ25hbCxcclxuICBFZmZlY3RDbGVhbnVwUmVnaXN0ZXJGbixcclxuICBJbnB1dFNpZ25hbFdpdGhUcmFuc2Zvcm1cclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgUGxhdGZvcm0gfSBmcm9tICdAYW5ndWxhci9jZGsvcGxhdGZvcm0nO1xyXG5pbXBvcnQgeyBEaXJlY3Rpb24sIERpcmVjdGlvbmFsaXR5IH0gZnJvbSAnQGFuZ3VsYXIvY2RrL2JpZGknO1xyXG5pbXBvcnQgeyB0b1NpZ25hbCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUvcnhqcy1pbnRlcm9wJztcclxuaW1wb3J0IHsgU3Vic2NyaXB0aW9uLCBtYXAsIHRhcCB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQge1xyXG4gIFNtb290aFNjcm9sbEVsZW1lbnQsXHJcbiAgU21vb3RoU2Nyb2xsTWFuYWdlcixcclxuICBTbW9vdGhTY3JvbGxUb0VsZW1lbnRPcHRpb25zLFxyXG4gIFNtb290aFNjcm9sbFRvT3B0aW9uc1xyXG59IGZyb20gJ25neC1zY3JvbGxiYXIvc21vb3RoLXNjcm9sbCc7XHJcbmltcG9ydCB7IFNjcm9sbGJhcnMgfSBmcm9tICcuL3Njcm9sbGJhcnMvc2Nyb2xsYmFycyc7XHJcbmltcG9ydCB7IF9OZ1Njcm9sbGJhciwgTkdfU0NST0xMQkFSIH0gZnJvbSAnLi91dGlscy9zY3JvbGxiYXItYmFzZSc7XHJcbmltcG9ydCB7IHJlc2l6ZU9ic2VydmVyLCBWaWV3cG9ydEFkYXB0ZXIgfSBmcm9tICcuL3ZpZXdwb3J0JztcclxuaW1wb3J0IHsgU2Nyb2xsYmFyRHJhZ2dpbmcsIFZpZXdwb3J0Qm91bmRhcmllcyB9IGZyb20gJy4vdXRpbHMvY29tbW9uJztcclxuaW1wb3J0IHtcclxuICBTY3JvbGxiYXJBcHBlYXJhbmNlLFxyXG4gIFNjcm9sbGJhclBvc2l0aW9uLFxyXG4gIFNjcm9sbGJhck9yaWVudGF0aW9uLFxyXG4gIFNjcm9sbGJhclVwZGF0ZVJlYXNvbixcclxuICBTY3JvbGxiYXJWaXNpYmlsaXR5LFxyXG4gIE5nU2Nyb2xsYmFyT3B0aW9ucyxcclxuICBOR19TQ1JPTExCQVJfT1BUSU9OU1xyXG59IGZyb20gJy4vbmctc2Nyb2xsYmFyLm1vZGVsJztcclxuXHJcbmNvbnN0IGRlZmF1bHRPcHRpb25zOiBOZ1Njcm9sbGJhck9wdGlvbnMgPSB7XHJcbiAgdHJhY2tDbGFzczogJycsXHJcbiAgdGh1bWJDbGFzczogJycsXHJcbiAgYnV0dG9uQ2xhc3M6ICcnLFxyXG4gIG9yaWVudGF0aW9uOiAnYXV0bycsXHJcbiAgYXBwZWFyYW5jZTogJ25hdGl2ZScsXHJcbiAgdmlzaWJpbGl0eTogJ25hdGl2ZScsXHJcbiAgcG9zaXRpb246ICduYXRpdmUnLFxyXG4gIHRyYWNrU2Nyb2xsRHVyYXRpb246IDUwLFxyXG4gIHNlbnNvclRocm90dGxlVGltZTogMCxcclxuICBkaXNhYmxlU2Vuc29yOiBmYWxzZSxcclxuICBkaXNhYmxlSW50ZXJhY3Rpb246IGZhbHNlLFxyXG4gIGJ1dHRvbnM6IGZhbHNlXHJcbn07XHJcblxyXG5pbnRlcmZhY2UgVmlld3BvcnRTdGF0ZSB7XHJcbiAgdmVydGljYWxVc2VkOiBib29sZWFuLFxyXG4gIGhvcml6b250YWxVc2VkOiBib29sZWFuLFxyXG4gIGlzVmVydGljYWxseVNjcm9sbGFibGU6IGJvb2xlYW4sXHJcbiAgaXNIb3Jpem9udGFsbHlTY3JvbGxhYmxlOiBib29sZWFuLFxyXG59XHJcblxyXG5ARGlyZWN0aXZlKHtcclxuICBob3N0OiB7XHJcbiAgICAnW2NsYXNzLm5nLXNjcm9sbGJhcl0nOiAndHJ1ZScsXHJcbiAgICAnW2F0dHIudmVydGljYWxVc2VkXSc6ICd2ZXJ0aWNhbFVzZWQoKScsXHJcbiAgICAnW2F0dHIuaG9yaXpvbnRhbFVzZWRdJzogJ2hvcml6b250YWxVc2VkKCknLFxyXG4gICAgJ1thdHRyLmlzVmVydGljYWxseVNjcm9sbGFibGVdJzogJ2lzVmVydGljYWxseVNjcm9sbGFibGUoKScsXHJcbiAgICAnW2F0dHIuaXNIb3Jpem9udGFsbHlTY3JvbGxhYmxlXSc6ICdpc0hvcml6b250YWxseVNjcm9sbGFibGUoKScsXHJcbiAgICAnW2F0dHIubW9iaWxlXSc6ICdpc01vYmlsZScsXHJcbiAgICAnW2F0dHIuZGlyXSc6ICdkaXJlY3Rpb24oKScsXHJcbiAgICAnW2F0dHIucG9zaXRpb25dJzogJ3Bvc2l0aW9uJyxcclxuICAgICdbYXR0ci5kcmFnZ2luZ10nOiAnZHJhZ2dpbmcoKScsXHJcbiAgICAnW2F0dHIuYXBwZWFyYW5jZV0nOiAnYXBwZWFyYW5jZScsXHJcbiAgICAnW2F0dHIudmlzaWJpbGl0eV0nOiAndmlzaWJpbGl0eSgpJyxcclxuICAgICdbYXR0ci5vcmllbnRhdGlvbl0nOiAnb3JpZW50YXRpb24oKScsXHJcbiAgICAnW2F0dHIuZGlzYWJsZUludGVyYWN0aW9uXSc6ICdkaXNhYmxlSW50ZXJhY3Rpb24oKSdcclxuICB9LFxyXG4gIHByb3ZpZGVyczogW3sgcHJvdmlkZTogTkdfU0NST0xMQkFSLCB1c2VFeGlzdGluZzogTmdTY3JvbGxiYXJDb3JlIH1dXHJcbn0pXHJcbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBOZ1Njcm9sbGJhckNvcmUgaW1wbGVtZW50cyBfTmdTY3JvbGxiYXIsIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCB7XHJcblxyXG4gIC8qKiBJbmplY3RlZCBvcHRpb25zICovXHJcbiAgcHJpdmF0ZSByZWFkb25seSBpbmplY3RlZE9wdGlvbnM6IE5nU2Nyb2xsYmFyT3B0aW9ucyA9IGluamVjdChOR19TQ1JPTExCQVJfT1BUSU9OUywgeyBvcHRpb25hbDogdHJ1ZSB9KTtcclxuXHJcbiAgLyoqIENvbWJpbmUgaW5qZWN0ZWQgb3B0aW9uIHdpdGggZGVmYXVsdCBvcHRpb25zICovXHJcbiAgcHJpdmF0ZSByZWFkb25seSBvcHRpb25zOiBOZ1Njcm9sbGJhck9wdGlvbnMgPSB0aGlzLmluamVjdGVkT3B0aW9ucyA/IHsgLi4uZGVmYXVsdE9wdGlvbnMsIC4uLnRoaXMuaW5qZWN0ZWRPcHRpb25zIH0gOiBkZWZhdWx0T3B0aW9ucztcclxuXHJcbiAgcHJpdmF0ZSByZWFkb25seSB6b25lOiBOZ1pvbmUgPSBpbmplY3QoTmdab25lKTtcclxuICBwcml2YXRlIHJlYWRvbmx5IHBsYXRmb3JtOiBQbGF0Zm9ybSA9IGluamVjdChQbGF0Zm9ybSk7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBpbmplY3RvcjogSW5qZWN0b3IgPSBpbmplY3QoSW5qZWN0b3IpO1xyXG5cclxuICAvKiogQSBmbGFnIHRoYXQgaW5kaWNhdGVzIGlmIHRoZSBwbGF0Zm9ybSBpcyBtb2JpbGUgKi9cclxuICByZWFkb25seSBpc01vYmlsZTogYm9vbGVhbiA9IHRoaXMucGxhdGZvcm0uSU9TIHx8IHRoaXMucGxhdGZvcm0uQU5EUk9JRDtcclxuICBkaXI6IERpcmVjdGlvbmFsaXR5ID0gaW5qZWN0KERpcmVjdGlvbmFsaXR5KTtcclxuXHJcbiAgc21vb3RoU2Nyb2xsOiBTbW9vdGhTY3JvbGxNYW5hZ2VyID0gaW5qZWN0KFNtb290aFNjcm9sbE1hbmFnZXIpO1xyXG5cclxuICBuYXRpdmVFbGVtZW50OiBIVE1MRWxlbWVudCA9IGluamVjdChFbGVtZW50UmVmPEhUTUxFbGVtZW50PikubmF0aXZlRWxlbWVudDtcclxuXHJcbiAgLyoqXHJcbiAgICogSW5kaWNhdGVzIGlmIHRoZSBkaXJlY3Rpb24gaXMgJ2x0cicgb3IgJ3J0bCdcclxuICAgKi9cclxuICBkaXJlY3Rpb246IFNpZ25hbDxEaXJlY3Rpb24+O1xyXG5cclxuICAvKipcclxuICAgKiBJbmRpY2F0ZXMgd2hlbiBzY3JvbGxiYXIgdGh1bWIgaXMgYmVpbmcgZHJhZ2dlZFxyXG4gICAqL1xyXG4gIGRyYWdnaW5nOiBXcml0YWJsZVNpZ25hbDxTY3JvbGxiYXJEcmFnZ2luZz4gPSBzaWduYWwoJ25vbmUnKTtcclxuXHJcbiAgLyoqXHJcbiAgICogU2V0cyB0aGUgc3VwcG9ydGVkIHNjcm9sbCB0cmFjayBvZiB0aGUgdmlld3BvcnQsIHRoZXJlIGFyZSAzIG9wdGlvbnM6XHJcbiAgICpcclxuICAgKiAtIGB2ZXJ0aWNhbGAgVXNlIGJvdGggdmVydGljYWwgYW5kIGhvcml6b250YWwgc2Nyb2xsYmFyXHJcbiAgICogLSBgaG9yaXpvbnRhbGAgVXNlIGJvdGggdmVydGljYWwgYW5kIGhvcml6b250YWwgc2Nyb2xsYmFyXHJcbiAgICogLSBgYXV0b2AgVXNlIGJvdGggdmVydGljYWwgYW5kIGhvcml6b250YWwgc2Nyb2xsYmFyXHJcbiAgICovXHJcbiAgb3JpZW50YXRpb246IElucHV0U2lnbmFsPFNjcm9sbGJhck9yaWVudGF0aW9uPiA9IGlucHV0PFNjcm9sbGJhck9yaWVudGF0aW9uPih0aGlzLm9wdGlvbnMub3JpZW50YXRpb24pO1xyXG5cclxuICAvKipcclxuICAgKiBXaGVuIHRvIHNob3cgdGhlIHNjcm9sbGJhciwgYW5kIHRoZXJlIGFyZSAzIG9wdGlvbnM6XHJcbiAgICpcclxuICAgKiAtIGBuYXRpdmVgIChkZWZhdWx0KSBTY3JvbGxiYXIgd2lsbCBiZSB2aXNpYmxlIHdoZW4gdmlld3BvcnQgaXMgc2Nyb2xsYWJsZSBsaWtlIHdpdGggbmF0aXZlIHNjcm9sbGJhclxyXG4gICAqIC0gYGhvdmVyYCBTY3JvbGxiYXJzIGFyZSBoaWRkZW4gYnkgZGVmYXVsdCwgb25seSB2aXNpYmxlIG9uIHNjcm9sbGluZyBvciBob3ZlcmluZ1xyXG4gICAqIC0gYGFsd2F5c2AgU2Nyb2xsYmFycyBhcmUgYWx3YXlzIHNob3duIGV2ZW4gaWYgdGhlIHZpZXdwb3J0IGlzIG5vdCBzY3JvbGxhYmxlXHJcbiAgICovXHJcbiAgdmlzaWJpbGl0eTogSW5wdXRTaWduYWw8U2Nyb2xsYmFyVmlzaWJpbGl0eT4gPSBpbnB1dDxTY3JvbGxiYXJWaXNpYmlsaXR5Pih0aGlzLm9wdGlvbnMudmlzaWJpbGl0eSk7XHJcblxyXG4gIC8qKiBTaG93IHNjcm9sbGJhciBidXR0b25zICovXHJcbiAgYnV0dG9uczogSW5wdXRTaWduYWxXaXRoVHJhbnNmb3JtPGJvb2xlYW4sIHN0cmluZyB8IGJvb2xlYW4+ID0gaW5wdXQ8Ym9vbGVhbiwgc3RyaW5nIHwgYm9vbGVhbj4odGhpcy5vcHRpb25zLmJ1dHRvbnMsIHtcclxuICAgIHRyYW5zZm9ybTogYm9vbGVhbkF0dHJpYnV0ZVxyXG4gIH0pO1xyXG5cclxuICAvKiogRGlzYWJsZXMgc2Nyb2xsYmFyIGludGVyYWN0aW9uIGxpa2UgZHJhZ2dpbmcgdGh1bWIgYW5kIGp1bXBpbmcgYnkgdHJhY2sgY2xpY2sgKi9cclxuICBkaXNhYmxlSW50ZXJhY3Rpb246IElucHV0U2lnbmFsV2l0aFRyYW5zZm9ybTxib29sZWFuLCBzdHJpbmcgfCBib29sZWFuPiA9IGlucHV0PGJvb2xlYW4sIHN0cmluZyB8IGJvb2xlYW4+KHRoaXMub3B0aW9ucy5kaXNhYmxlSW50ZXJhY3Rpb24sIHtcclxuICAgIHRyYW5zZm9ybTogYm9vbGVhbkF0dHJpYnV0ZVxyXG4gIH0pO1xyXG5cclxuICAvKiogV2hldGhlciBSZXNpemVPYnNlcnZlciBpcyBkaXNhYmxlZCAqL1xyXG4gIGRpc2FibGVTZW5zb3I6IElucHV0U2lnbmFsV2l0aFRyYW5zZm9ybTxib29sZWFuLCBzdHJpbmcgfCBib29sZWFuPiA9IGlucHV0PGJvb2xlYW4sIHN0cmluZyB8IGJvb2xlYW4+KHRoaXMub3B0aW9ucy5kaXNhYmxlU2Vuc29yLCB7XHJcbiAgICB0cmFuc2Zvcm06IGJvb2xlYW5BdHRyaWJ1dGVcclxuICB9KTtcclxuXHJcbiAgLyoqIFRocm90dGxlIGludGVydmFsIGZvciBkZXRlY3RpbmcgY2hhbmdlcyB2aWEgUmVzaXplT2JzZXJ2ZXIgKi9cclxuICBzZW5zb3JUaHJvdHRsZVRpbWU6IElucHV0U2lnbmFsPG51bWJlcj4gPSBpbnB1dDxudW1iZXIsIG51bWJlcj4odGhpcy5vcHRpb25zLnNlbnNvclRocm90dGxlVGltZSwge1xyXG4gICAgdHJhbnNmb3JtOiBudW1iZXJBdHRyaWJ1dGVcclxuICB9KTtcclxuXHJcbiAgdmlld3BvcnREaW1lbnNpb246IFdyaXRhYmxlU2lnbmFsPFZpZXdwb3J0Qm91bmRhcmllcz4gPSBzaWduYWwoe1xyXG4gICAgY29udGVudEhlaWdodDogMCxcclxuICAgIGNvbnRlbnRXaWR0aDogMCxcclxuICAgIG9mZnNldEhlaWdodDogMCxcclxuICAgIG9mZnNldFdpZHRoOiAwXHJcbiAgfSk7XHJcblxyXG4gIHN0YXRlOiBTaWduYWw8Vmlld3BvcnRTdGF0ZT4gPSBjb21wdXRlZCgoKSA9PiB7XHJcbiAgICBsZXQgdmVydGljYWxVc2VkOiBib29sZWFuID0gZmFsc2U7XHJcbiAgICBsZXQgaG9yaXpvbnRhbFVzZWQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIGxldCBpc1ZlcnRpY2FsbHlTY3JvbGxhYmxlOiBib29sZWFuID0gZmFsc2U7XHJcbiAgICBsZXQgaXNIb3Jpem9udGFsbHlTY3JvbGxhYmxlOiBib29sZWFuID0gZmFsc2U7XHJcblxyXG4gICAgY29uc3Qgb3JpZW50YXRpb246IFNjcm9sbGJhck9yaWVudGF0aW9uID0gdGhpcy5vcmllbnRhdGlvbigpO1xyXG4gICAgY29uc3QgdmlzaWJpbGl0eTogU2Nyb2xsYmFyVmlzaWJpbGl0eSA9IHRoaXMudmlzaWJpbGl0eSgpO1xyXG4gICAgY29uc3Qgdmlld3BvcnQ6IFZpZXdwb3J0Qm91bmRhcmllcyA9IHRoaXMudmlld3BvcnREaW1lbnNpb24oKTtcclxuXHJcbiAgICAvLyBDaGVjayBpZiB2ZXJ0aWNhbCBzY3JvbGxiYXIgc2hvdWxkIGJlIGRpc3BsYXllZFxyXG4gICAgaWYgKG9yaWVudGF0aW9uID09PSAnYXV0bycgfHwgb3JpZW50YXRpb24gPT09ICd2ZXJ0aWNhbCcpIHtcclxuICAgICAgaXNWZXJ0aWNhbGx5U2Nyb2xsYWJsZSA9IHZpZXdwb3J0LmNvbnRlbnRIZWlnaHQgPiB2aWV3cG9ydC5vZmZzZXRIZWlnaHQ7XHJcbiAgICAgIHZlcnRpY2FsVXNlZCA9IHZpc2liaWxpdHkgPT09ICd2aXNpYmxlJyB8fCBpc1ZlcnRpY2FsbHlTY3JvbGxhYmxlO1xyXG4gICAgfVxyXG4gICAgLy8gQ2hlY2sgaWYgaG9yaXpvbnRhbCBzY3JvbGxiYXIgc2hvdWxkIGJlIGRpc3BsYXllZFxyXG4gICAgaWYgKG9yaWVudGF0aW9uID09PSAnYXV0bycgfHwgb3JpZW50YXRpb24gPT09ICdob3Jpem9udGFsJykge1xyXG4gICAgICBpc0hvcml6b250YWxseVNjcm9sbGFibGUgPSB2aWV3cG9ydC5jb250ZW50V2lkdGggPiB2aWV3cG9ydC5vZmZzZXRXaWR0aDtcclxuICAgICAgaG9yaXpvbnRhbFVzZWQgPSB2aXNpYmlsaXR5ID09PSAndmlzaWJsZScgfHwgaXNIb3Jpem9udGFsbHlTY3JvbGxhYmxlO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHZlcnRpY2FsVXNlZCxcclxuICAgICAgaG9yaXpvbnRhbFVzZWQsXHJcbiAgICAgIGlzVmVydGljYWxseVNjcm9sbGFibGUsXHJcbiAgICAgIGlzSG9yaXpvbnRhbGx5U2Nyb2xsYWJsZSxcclxuICAgIH07XHJcbiAgfSk7XHJcblxyXG4gIGlzVmVydGljYWxseVNjcm9sbGFibGU6IFNpZ25hbDxib29sZWFuPiA9IGNvbXB1dGVkKCgpID0+IHRoaXMuc3RhdGUoKS5pc1ZlcnRpY2FsbHlTY3JvbGxhYmxlKTtcclxuICBpc0hvcml6b250YWxseVNjcm9sbGFibGU6IFNpZ25hbDxib29sZWFuPiA9IGNvbXB1dGVkKCgpID0+IHRoaXMuc3RhdGUoKS5pc0hvcml6b250YWxseVNjcm9sbGFibGUpO1xyXG4gIHZlcnRpY2FsVXNlZDogU2lnbmFsPGJvb2xlYW4+ID0gY29tcHV0ZWQoKCkgPT4gdGhpcy5zdGF0ZSgpLnZlcnRpY2FsVXNlZCk7XHJcbiAgaG9yaXpvbnRhbFVzZWQ6IFNpZ25hbDxib29sZWFuPiA9IGNvbXB1dGVkKCgpID0+IHRoaXMuc3RhdGUoKS5ob3Jpem9udGFsVXNlZCk7XHJcblxyXG4gIC8qKiBTY3JvbGwgZHVyYXRpb24gd2hlbiB0aGUgc2Nyb2xsIHRyYWNrIGlzIGNsaWNrZWQgKi9cclxuICBASW5wdXQoeyB0cmFuc2Zvcm06IG51bWJlckF0dHJpYnV0ZSB9KSB0cmFja1Njcm9sbER1cmF0aW9uOiBudW1iZXIgPSB0aGlzLm9wdGlvbnMudHJhY2tTY3JvbGxEdXJhdGlvbjtcclxuXHJcbiAgLyoqXHJcbiAgICogIFNldHMgdGhlIGFwcGVhcmFuY2Ugb2YgdGhlIHNjcm9sbGJhciwgdGhlcmUgYXJlIDIgb3B0aW9uczpcclxuICAgKlxyXG4gICAqIC0gYG5hdGl2ZWAgKGRlZmF1bHQpIHNjcm9sbGJhciBzcGFjZSB3aWxsIGJlIHJlc2VydmVkIGp1c3QgbGlrZSB3aXRoIG5hdGl2ZSBzY3JvbGxiYXIuXHJcbiAgICogLSBgY29tcGFjdGAgc2Nyb2xsYmFyIGRvZXNuJ3QgcmVzZXJ2ZSBhbnkgc3BhY2UsIHRoZXkgYXJlIHBsYWNlZCBvdmVyIHRoZSB2aWV3cG9ydC5cclxuICAgKi9cclxuICBASW5wdXQoKSBhcHBlYXJhbmNlOiBTY3JvbGxiYXJBcHBlYXJhbmNlID0gdGhpcy5vcHRpb25zLmFwcGVhcmFuY2U7XHJcbiAgLyoqXHJcbiAgICogU2V0cyB0aGUgcG9zaXRpb24gb2YgZWFjaCBzY3JvbGxiYXIsIHRoZXJlIGFyZSA0IG9wdGlvbnM6XHJcbiAgICpcclxuICAgKiAtIGBuYXRpdmVgIChEZWZhdWx0KSBVc2UgdGhlIGRlZmF1bHQgcG9zaXRpb24gbGlrZSBpbiBuYXRpdmUgc2Nyb2xsYmFyLlxyXG4gICAqIC0gYGludmVydFlgIEludmVydHMgdmVydGljYWwgc2Nyb2xsYmFyIHBvc2l0aW9uXHJcbiAgICogLSBgaW52ZXJ0WGAgSW52ZXJ0cyBIb3Jpem9udGFsIHNjcm9sbGJhciBwb3NpdGlvblxyXG4gICAqIC0gYGludmVydEFsbGAgSW52ZXJ0cyBib3RoIHNjcm9sbGJhciBwb3NpdGlvbnNcclxuICAgKi9cclxuICBASW5wdXQoKSBwb3NpdGlvbjogU2Nyb2xsYmFyUG9zaXRpb24gPSB0aGlzLm9wdGlvbnMucG9zaXRpb247XHJcblxyXG4gIC8qKiBBIGNsYXNzIGZvcndhcmRlZCB0byB0aGUgc2Nyb2xsYmFyIHRyYWNrIGVsZW1lbnQgKi9cclxuICBASW5wdXQoKSB0cmFja0NsYXNzOiBzdHJpbmcgPSB0aGlzLm9wdGlvbnMudHJhY2tDbGFzcztcclxuICAvKiogQSBjbGFzcyBmb3J3YXJkZWQgdG8gdGhlIHNjcm9sbGJhciB0aHVtYiBlbGVtZW50ICovXHJcbiAgQElucHV0KCkgdGh1bWJDbGFzczogc3RyaW5nID0gdGhpcy5vcHRpb25zLnRodW1iQ2xhc3M7XHJcbiAgLyoqIEEgY2xhc3MgZm9yd2FyZGVkIHRvIHRoZSBzY3JvbGxiYXIgYnV0dG9uIGVsZW1lbnQgKi9cclxuICBASW5wdXQoKSBidXR0b25DbGFzczogc3RyaW5nID0gdGhpcy5vcHRpb25zLnRodW1iQ2xhc3M7XHJcblxyXG4gIC8qKiBTdGVhbSB0aGF0IGVtaXRzIHdoZW4gc2Nyb2xsYmFyIGlzIGluaXRpYWxpemVkICovXHJcbiAgQE91dHB1dCgpIGFmdGVySW5pdDogRXZlbnRFbWl0dGVyPHZvaWQ+ID0gbmV3IEV2ZW50RW1pdHRlcjx2b2lkPigpO1xyXG5cclxuICAvKiogU3RlYW0gdGhhdCBlbWl0cyB3aGVuIHNjcm9sbGJhciBpcyB1cGRhdGVkICovXHJcbiAgQE91dHB1dCgpIGFmdGVyVXBkYXRlOiBFdmVudEVtaXR0ZXI8dm9pZD4gPSBuZXcgRXZlbnRFbWl0dGVyPHZvaWQ+KCk7XHJcblxyXG4gIC8qKiBSZXNpemUgb2JzZXJ2ZXIgc3Vic2NyaXB0aW9uICovXHJcbiAgcHJpdmF0ZSBzaXplQ2hhbmdlU3ViOiBTdWJzY3JpcHRpb247XHJcblxyXG4gIC8qKiBWaWV3cG9ydCBhZGFwdGVyIGluc3RhbmNlICovXHJcbiAgdmlld3BvcnQ6IFZpZXdwb3J0QWRhcHRlciA9IG5ldyBWaWV3cG9ydEFkYXB0ZXIoKTtcclxuXHJcbiAgLyoqIFRoZSBzY3JvbGxiYXJzIGNvbXBvbmVudCBpbnN0YW5jZSB1c2VkIGZvciB0ZXN0aW5nIHB1cnBvc2UgKi9cclxuICBhYnN0cmFjdCBfc2Nyb2xsYmFyczogU2Nyb2xsYmFycztcclxuXHJcbiAgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICBydW5JbkluamVjdGlvbkNvbnRleHQodGhpcy5pbmplY3RvciwgKCkgPT4ge1xyXG4gICAgICAvLyBUaGUgZGlyZWN0aW9uIHNpZ25hbCBjYW5ub3QgYmUgaW5pdGlhbGl6ZWQgaW4gdGhlIGNvbnN0cnVjdG9yXHJcbiAgICAgIC8vIEJlY2F1c2UgaXQgaW5pdGlhbGx5IHJldHVybnMgJ2x0cicgZXZlbiBpZiBkaXIudmFsdWUgaXMgJ3J0bGBcclxuICAgICAgdGhpcy5kaXJlY3Rpb24gPSB0b1NpZ25hbDxEaXJlY3Rpb24sIERpcmVjdGlvbj4odGhpcy5kaXIuY2hhbmdlLnBpcGUobWFwKCgpID0+IHRoaXMuZGlyLnZhbHVlKSksIHsgaW5pdGlhbFZhbHVlOiB0aGlzLmRpci52YWx1ZSB9KTtcclxuXHJcbiAgICAgIGVmZmVjdCgob25DbGVhbnVwOiBFZmZlY3RDbGVhbnVwUmVnaXN0ZXJGbikgPT4ge1xyXG4gICAgICAgIC8vIENoZWNrIHdoZXRoZXIgc2Vuc29yIHNob3VsZCBiZSBlbmFibGVkXHJcbiAgICAgICAgaWYgKHRoaXMuZGlzYWJsZVNlbnNvcigpKSB7XHJcbiAgICAgICAgICAvLyBJZiBzZW5zb3IgaXMgZGlzYWJsZWQgdXBkYXRlIG1hbnVhbGx5XHJcbiAgICAgICAgICB0aGlzLnNpemVDaGFuZ2VTdWI/LnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGlmICh0aGlzLnBsYXRmb3JtLmlzQnJvd3NlciAmJiB0aGlzLnZpZXdwb3J0LmluaXRpYWxpemVkKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5zaXplQ2hhbmdlU3ViPy51bnN1YnNjcmliZSgpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy56b25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcclxuICAgICAgICAgICAgICB0aGlzLnNpemVDaGFuZ2VTdWIgPSByZXNpemVPYnNlcnZlcih7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50OiB0aGlzLnZpZXdwb3J0Lm5hdGl2ZUVsZW1lbnQsXHJcbiAgICAgICAgICAgICAgICBjb250ZW50V3JhcHBlcjogdGhpcy52aWV3cG9ydC5jb250ZW50V3JhcHBlckVsZW1lbnQsXHJcbiAgICAgICAgICAgICAgICB0aHJvdHRsZUR1cmF0aW9uOiB0aGlzLnNlbnNvclRocm90dGxlVGltZSgpXHJcbiAgICAgICAgICAgICAgfSkucGlwZShcclxuICAgICAgICAgICAgICAgIHRhcCgocmVhc29uOiBTY3JvbGxiYXJVcGRhdGVSZWFzb24pID0+IHRoaXMudXBkYXRlKHJlYXNvbikpXHJcbiAgICAgICAgICAgICAgKS5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBvbkNsZWFudXAoKCkgPT4gdGhpcy5zaXplQ2hhbmdlU3ViPy51bnN1YnNjcmliZSgpKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpOiB2b2lkIHtcclxuICAgIC8vIElmIHNlbnNvciBpcyBkaXNhYmxlZCwgdXBkYXRlIHRvIGV2YWx1YXRlIHRoZSBzdGF0ZVxyXG4gICAgaWYgKHRoaXMucGxhdGZvcm0uaXNCcm93c2VyICYmIHRoaXMuZGlzYWJsZVNlbnNvcigpKSB7XHJcbiAgICAgIC8vIEluIGNhc2Ugb2YgM3JkIHBhcnR5IGxpYnJhcnksIG5lZWQgdG8gd2FpdCBmb3IgY29udGVudCB0byBiZSByZW5kZXJlZFxyXG4gICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xyXG4gICAgICAgIHRoaXMudXBkYXRlKFNjcm9sbGJhclVwZGF0ZVJlYXNvbi5BZnRlckluaXQpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFVwZGF0ZSBsb2NhbCBzdGF0ZSBhbmQgdGhlIGludGVybmFsIHNjcm9sbGJhciBjb250cm9sc1xyXG4gICAqL1xyXG4gIHVwZGF0ZShyZWFzb24/OiBTY3JvbGxiYXJVcGRhdGVSZWFzb24pOiB2b2lkIHtcclxuICAgIHRoaXMudXBkYXRlQ1NTVmFyaWFibGVzKCk7XHJcblxyXG4gICAgdGhpcy56b25lLnJ1bigoKSA9PiB7XHJcbiAgICAgIHRoaXMudmlld3BvcnREaW1lbnNpb24uc2V0KHtcclxuICAgICAgICBjb250ZW50SGVpZ2h0OiB0aGlzLnZpZXdwb3J0LmNvbnRlbnRIZWlnaHQsXHJcbiAgICAgICAgY29udGVudFdpZHRoOiB0aGlzLnZpZXdwb3J0LmNvbnRlbnRXaWR0aCxcclxuICAgICAgICBvZmZzZXRIZWlnaHQ6IHRoaXMudmlld3BvcnQub2Zmc2V0SGVpZ2h0LFxyXG4gICAgICAgIG9mZnNldFdpZHRoOiB0aGlzLnZpZXdwb3J0Lm9mZnNldFdpZHRoXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLy8gQWZ0ZXIgdGhlIHVwZ3JhZGUgdG8gQW5ndWxhciAxOCwgdGhlIGVmZmVjdCBmdW5jdGlvbnMgaW4gdGhlIGlubmVyIGRpcmVjdGl2ZXMgYXJlIGV4ZWN1dGVkIGFmdGVyIFwiYWZ0ZXJJbml0XCIgaXMgZW1pdHRlZCxcclxuICAgICAgLy8gY2F1c2luZyB0aGUgdGVzdHMgdG8gZmFpbC4gQSB0aW55IGRlbGF5IGlzIG5lZWRlZCBiZWZvcmUgZW1pdHRpbmcgdG8gdGhlIG91dHB1dCBhcyBhIHdvcmthcm91bmQuXHJcbiAgICAgIGlmIChyZWFzb24gPT09IFNjcm9sbGJhclVwZGF0ZVJlYXNvbi5BZnRlckluaXQpIHtcclxuICAgICAgICB0aGlzLmFmdGVySW5pdC5lbWl0KCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5hZnRlclVwZGF0ZS5lbWl0KCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU21vb3RoIHNjcm9sbCBmdW5jdGlvbnNcclxuICAgKi9cclxuICBzY3JvbGxUbyhvcHRpb25zOiBTbW9vdGhTY3JvbGxUb09wdGlvbnMpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIHJldHVybiB0aGlzLnNtb290aFNjcm9sbC5zY3JvbGxUbyh0aGlzLnZpZXdwb3J0IS5uYXRpdmVFbGVtZW50LCBvcHRpb25zKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNjcm9sbCB0byBlbGVtZW50IGJ5IHJlZmVyZW5jZSBvciBzZWxlY3RvclxyXG4gICAqL1xyXG4gIHNjcm9sbFRvRWxlbWVudCh0YXJnZXQ6IFNtb290aFNjcm9sbEVsZW1lbnQsIG9wdGlvbnM/OiBTbW9vdGhTY3JvbGxUb0VsZW1lbnRPcHRpb25zKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICByZXR1cm4gdGhpcy5zbW9vdGhTY3JvbGwuc2Nyb2xsVG9FbGVtZW50KHRoaXMudmlld3BvcnQubmF0aXZlRWxlbWVudCwgdGFyZ2V0LCBvcHRpb25zKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFVwZGF0ZSBFc3NlbnRpYWwgQ1NTIHZhcmlhYmxlc1xyXG4gICAqL1xyXG4gIHByaXZhdGUgdXBkYXRlQ1NTVmFyaWFibGVzKCk6IHZvaWQge1xyXG4gICAgdGhpcy5uYXRpdmVFbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KCctLWNvbnRlbnQtaGVpZ2h0JywgYCR7IHRoaXMudmlld3BvcnQuY29udGVudEhlaWdodCB9YCk7XHJcbiAgICB0aGlzLm5hdGl2ZUVsZW1lbnQuc3R5bGUuc2V0UHJvcGVydHkoJy0tY29udGVudC13aWR0aCcsIGAkeyB0aGlzLnZpZXdwb3J0LmNvbnRlbnRXaWR0aCB9YCk7XHJcbiAgICB0aGlzLm5hdGl2ZUVsZW1lbnQuc3R5bGUuc2V0UHJvcGVydHkoJy0tdmlld3BvcnQtaGVpZ2h0JywgYCR7IHRoaXMudmlld3BvcnQub2Zmc2V0SGVpZ2h0IH1gKTtcclxuICAgIHRoaXMubmF0aXZlRWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eSgnLS12aWV3cG9ydC13aWR0aCcsIGAkeyB0aGlzLnZpZXdwb3J0Lm9mZnNldFdpZHRoIH1gKTtcclxuICB9XHJcbn1cclxuIl19